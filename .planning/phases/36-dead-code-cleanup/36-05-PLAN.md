---
phase: 36-dead-code-cleanup
plan: 05
type: execute
wave: 5
depends_on: ["36-04"]
files_modified:
  - src/styles/design-tokens.css
  - src/v2/styles/tokens.css
  - src/v2/styles/canvas-atmosphere.css
  - src/v2/styles/gradient-mesh.css
  - src/v2/styles/v2.css
  - src/v2/styles/landing.css
  - src/v2/styles/responsive.css
autonomous: true

must_haves:
  truths:
    - "Canvas pages have correct visual styling after token cleanup"
    - "No CSS variables used by Canvas are missing"
    - "Build succeeds with zero errors"
    - "Bundle size is measurably reduced compared to baseline"
    - "All tests pass"
  artifacts:
    - path: "dist/"
      provides: "Final build with reduced bundle size"
    - path: ".planning/phases/36-dead-code-cleanup/36-BASELINE.md"
      provides: "Before/after bundle size comparison"
  key_links:
    - from: "src/v2/pages/canvas/*"
      to: "src/v2/styles/*.css"
      via: "CSS variable references"
      pattern: "var\\(--"
---

<objective>
Remove dead CSS design tokens (V1 and warm/copper remnants), audit and remove dead hooks/utils/barrel files, and produce a final bundle size comparison showing cleanup impact.

Purpose: This is the final cleanup sweep. V1 design tokens are completely unused. V2 CSS files may contain warm/copper token definitions that Canvas no longer references. Dead hooks and barrel exports inflate the codebase. The final bundle comparison validates the entire Phase 36 effort.
Output: Dead CSS tokens removed, dead hooks/utils cleaned, final bundle size comparison documented.
</objective>

<execution_context>
@/home/swd/.claude/get-shit-done/workflows/execute-plan.md
@/home/swd/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/36-dead-code-cleanup/36-RESEARCH.md
@.planning/phases/36-dead-code-cleanup/36-04-SUMMARY.md
@.planning/phases/36-dead-code-cleanup/36-BASELINE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove dead CSS files and clean token files</name>
  <files>
    src/styles/design-tokens.css
    src/v2/styles/tokens.css
    src/v2/styles/canvas-atmosphere.css
    src/v2/styles/gradient-mesh.css
    src/v2/styles/landing.css
    src/v2/styles/responsive.css
  </files>
  <action>
**Step 1: Check if V1 design-tokens.css is imported anywhere.**
```bash
grep -r "design-tokens\|design-tokens.css" src/ --include="*.{jsx,tsx,ts,js,css}" -l 2>/dev/null
```

If it is only imported by dead code or not imported at all: `rm src/styles/design-tokens.css`
If it IS imported by kept code (App.css, V2Layout, CanvasLayout), check what tokens Canvas uses from it and either keep the file or migrate needed tokens to Canvas CSS.

**Step 2: Check if landing.css is imported by LandingPage.tsx.**
```bash
grep -r "landing.css\|landing" src/pages/LandingPage.tsx --include="*.{tsx}" 2>/dev/null
```
If LandingPage.tsx imports landing.css: KEEP it.
If not: `rm src/v2/styles/landing.css`

**Step 3: Check gradient-mesh.css usage.**
```bash
grep -r "gradient-mesh\|gradient-mesh.css" src/ --include="*.{jsx,tsx,ts,js,css}" -l 2>/dev/null
```
If only imported by deleted mesh pages: `rm src/v2/styles/gradient-mesh.css`

**Step 4: Audit canvas-atmosphere.css.**
```bash
# Check what imports canvas-atmosphere.css
grep -r "canvas-atmosphere" src/ --include="*.{jsx,tsx,ts,js,css}" -l 2>/dev/null
```
If imported by Canvas layout or components: KEEP but audit for warm/copper token definitions that are unused.
If not imported: `rm src/v2/styles/canvas-atmosphere.css`

**Step 5: Audit tokens.css for warm/copper remnants.**
```bash
# Check what imports tokens.css
grep -r "tokens.css\|from.*tokens" src/ --include="*.{jsx,tsx,ts,js,css}" -l 2>/dev/null
```

If tokens.css is imported, read it and identify warm/copper-specific token definitions (look for `--warm-`, `--copper-`, `--stone-` prefixed variables). Cross-reference against Canvas component usage:
```bash
# Find all CSS variables Canvas components reference
grep -roh "var(--[a-zA-Z0-9-]*)" src/v2/pages/canvas/ src/v2/features/ --include="*.{tsx,jsx,css}" 2>/dev/null | sort -u
```

Remove any token definitions NOT in the Canvas variable reference list. Be conservative — keep tokens you are unsure about.

**Step 6: Audit responsive.css.**
```bash
grep -r "responsive.css\|responsive" src/ --include="*.{jsx,tsx,ts,js,css}" -l 2>/dev/null | head -10
```
If imported by Canvas: KEEP.
If not: remove or audit for Canvas-used rules.

**Step 7: Check src/styles/ directory for any other dead CSS files.**
```bash
ls src/styles/
```
Remove any files not imported by kept code.
  </action>
  <verify>
`npm run build` succeeds.
No CSS "undefined variable" warnings in build output.
  </verify>
  <done>Dead CSS files removed, warm/copper tokens cleaned from remaining CSS files</done>
</task>

<task type="auto">
  <name>Task 2: Audit and remove dead hooks, utils, and barrel files</name>
  <files>
    src/v2/hooks/
    src/v2/utils/
    src/v2/lib/
    src/v2/features/*/index.ts
    src/v2/components/*/index.ts
  </files>
  <action>
**Step 1: Find hooks only used by deleted pages.**
```bash
# List all hooks
ls src/v2/hooks/ 2>/dev/null

# For each hook, check if it's imported by Canvas/V2 code still in use
for hook in $(ls src/v2/hooks/*.{ts,tsx} 2>/dev/null); do
  hookname=$(basename "$hook" | sed 's/\.[^.]*$//')
  importers=$(grep -r "$hookname" src/v2/ --include="*.{jsx,tsx,ts}" -l 2>/dev/null | grep -v "hooks/$hookname" | grep -v ".test.")
  if [ -z "$importers" ]; then
    echo "DEAD: $hook"
  fi
done
```

Delete any hooks with zero importers (after verifying they are not re-exported through barrel files that ARE used).

**Step 2: Find dead utils.**
```bash
ls src/v2/utils/ 2>/dev/null

for util in $(ls src/v2/utils/*.{ts,tsx,js} 2>/dev/null); do
  utilname=$(basename "$util" | sed 's/\.[^.]*$//')
  importers=$(grep -r "$utilname" src/ --include="*.{jsx,tsx,ts,js}" -l 2>/dev/null | grep -v "utils/$utilname" | grep -v ".test.")
  if [ -z "$importers" ]; then
    echo "DEAD: $util"
  fi
done
```

Delete dead utils.

**Step 3: Clean barrel files (index.ts exports).**
```bash
# Find barrel files that export deleted modules
find src/v2/features/ -name "index.ts" -o -name "index.tsx" 2>/dev/null | while read barrel; do
  echo "=== $barrel ==="
  # Check for exports of deleted files
  grep "export" "$barrel" 2>/dev/null
done
```

For each barrel file:
- Remove export lines referencing deleted files
- If the barrel file becomes empty, delete it
- If the barrel file still has valid exports, keep it

**Step 4: Clean up any remaining dead V2 feature directories.**

After removing dead pages and components, some feature directories might be empty or contain only dead code:
```bash
# Check if any feature directories are empty
find src/v2/features/ -type d -empty 2>/dev/null
```

Remove empty directories.

**Step 5: Quick scan for any remaining dead imports.**
```bash
# Build check will catch these, but proactive scan
npm run build 2>&1 | grep "Could not resolve\|Cannot find module" | head -20
```

Fix any remaining broken imports.
  </action>
  <verify>
`npm run build` succeeds with zero errors.
No empty directories remain.
  </verify>
  <done>Dead hooks, utils, and barrel file exports cleaned up</done>
</task>

<task type="auto">
  <name>Task 3: Final build, bundle comparison, and commit</name>
  <files>
    dist/
    .planning/phases/36-dead-code-cleanup/36-BASELINE.md
  </files>
  <action>
**Step 1: Run full verification suite.**
```bash
npm run build
npm run test:run 2>&1 | tail -30
```

Both must pass. Fix any remaining issues.

**Step 2: Measure final bundle size and compare to baseline.**
```bash
du -sh dist/
ls -lhS dist/assets/*.js | head -10
ls -lhS dist/assets/*.css | head -5
```

**Step 3: Update 36-BASELINE.md with comparison.**

Append to `.planning/phases/36-dead-code-cleanup/36-BASELINE.md`:
```
## Post-Cleanup (Plan 05)
Date: [timestamp]
Total JS: [size]
Total CSS: [size]
Largest chunks: [list top 5]

## Bundle Size Reduction
JS reduction: [before] → [after] ([percentage]%)
CSS reduction: [before] → [after] ([percentage]%)
Total reduction: [before] → [after] ([percentage]%)
```

**Step 4: Final commit.**
```bash
git add -A
git commit -m "chore(36-05): remove dead CSS tokens, hooks, utils, and barrel exports

- Remove V1 design-tokens.css
- Clean warm/copper tokens from V2 CSS files
- Remove dead hooks and utilities
- Clean barrel file exports for deleted modules
- Bundle size reduced: [X]% (JS), [Y]% (CSS)

Phase 36 (Dead Code Cleanup) complete."
```

**Step 5: Count total files and lines removed across all Phase 36 plans.**
```bash
# Quick summary
echo "=== Phase 36 Summary ==="
echo "Files in src/: $(find src/ -type f | wc -l)"
echo "V2 pages remaining: $(ls src/v2/pages/canvas/ | wc -l) Canvas pages"
echo "V1 pages remaining: $(ls src/pages/ | wc -l) files"
echo "Stores remaining: $(ls src/store/ | wc -l) files"
echo "Build status: $(npm run build 2>&1 | tail -1)"
```
  </action>
  <verify>
`npm run build` succeeds.
`npm run test:run` passes.
36-BASELINE.md contains before/after comparison.
Git log shows final commit.
  </verify>
  <done>Plan 05 complete — all dead CSS/hooks/utils removed, bundle comparison documented, Phase 36 complete</done>
</task>

</tasks>

<verification>
1. `npm run build` succeeds with zero errors
2. `npm run test:run` all tests pass
3. Bundle size comparison shows measurable reduction
4. No dead V1/V2 CSS token files remain
5. No dead hooks, utils, or barrel exports remain
6. Canvas pages render with correct styling
</verification>

<success_criteria>
- V1 design-tokens.css removed
- Warm/copper tokens cleaned from V2 CSS files
- Dead hooks and utils removed
- Barrel file exports cleaned
- Bundle size reduction documented (target: 20-40% JS reduction)
- Phase 36 fully complete with all 5 plans executed
</success_criteria>

<output>
After completion, create `.planning/phases/36-dead-code-cleanup/36-05-SUMMARY.md`
</output>
